{
    "bookSourceComment": "//by SunQAQ\r\n//24.05.31--修复了\"漫画加入书架后，过一段时间后打开报错\"的问题。\r\n//24.05.28--优化页码问题，现在不再出现图片重复。\r\n//24.04.22--优化，发现不再需要刷新。\r\n//登录才能用，没有账号的话需要注册。\r\n//网络不稳定，有时需开梯。\r\n//var authorization = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI1ZmQ5NTI0NzY4M2FlMzFkOThjNGU3NGQiLCJlbWFpbCI6IjI3NDk3ODg4NyIsInJvbGUiOiJtZW1iZXIiLCJuYW1lIjoiU3VuUSIsInZlcnNpb24iOiIyLjIuMS4zLjMuNCIsImJ1aWxkVmVyc2lvbiI6IjQ1IiwicGxhdGZvcm0iOiJhbmRyb2lkIiwiaWF0IjoxNzEwMTQzMTU1LCJleHAiOjE3MTA3NDc5NTV9.IyHHyZUSGTfmFVCcFBwHAqiWFDbVp4IP1yOP5oGO4pw\";\r\nauthorization = cache.get(\"authorization\");\r\nvar appleKillFlag = 'C69BAF41DA5ABD1FFEDC6D2FEA56B';\r\nvar appleVerSion = '~d}$Q7$eIni=V)9\\\\RK/P.RM4;9[7|@/CA}b~OW!3?EV`:<>M7pddUBL5n|0/*Cn';\r\nvar nonce = \"3kxxmdefitn7babbbemxkeattems3ptx\";\r\nvar setTime = (new Date().getTime() / 1000).toFixed(0);\r\nfunction getsignature(pathname, ts, method) {\r\n    var raw = pathname + ts + nonce + method + appleKillFlag;\r\n    raw = raw.toLowerCase();\r\n    return java.HMacHex(raw, \"HmacSHA256\", appleVerSion);\r\n}\r\nfunction getheaders(setTime, nonce, signature) {\r\n    var header = \"\\\"Time\\\":\\\"\" + setTime + \"\\\",\\\"Content-Type\\\":\\\"application/json; charset=UTF-8\\\",\\\"nonce\\\":\\\"\" + nonce + \"\\\", \\\"signature\\\":\\\"\" + signature + \"\\\",\\\"Accept\\\":\\\"application/vnd.picacomic.com.v1+json\\\",\\\"app-uuid\\\":\\\"webUUID\\\",\\\"authorization\\\":\\\"\" + authorization + \"\\\",\\\"app-platform\\\":\\\"android\\\",\\\"app-channel\\\":\\\"1\\\",\\\"Host\\\":\\\"api.go2778.com\\\",\\\"User-Agent\\\":\\\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36 Edg/120.0.0.0\\\"\";\r\n    return header;\r\n}",
    "bookSourceGroup": "?漫画,?其一,?涩涩",
    "bookSourceName": "?▲哔咔哔咔manhuapica",
    "bookSourceType": 2,
    "bookSourceUrl": "https://manhuapica.com",
    "customOrder": 1,
    "enabled": true,
    "enabledCookieJar": false,
    "enabledExplore": true,
    "exploreUrl": "<js>\neval(String(source.bookSourceComment));\r\nfunction explore(a, b, c, d, e) {\r\n    style = \"{title: \\\"\" + a + \"\\\",url: \\\"\" + b + \"\\\",style: {layout_flexGrow:\" + c + \",layout_flexBasisPercent:\" + d + \",layout_wrapBefore: \" + e + \"}}\";\r\n    return style;\r\n}\r\nvar exploreUrl = [];\r\ntitle = [\"本日排行\", \"本周排行\", \"本月排行\"];\r\ntype = [\"tt=H24&ct=VC\", \"tt=D7&ct=VC\", \"tt=D30&ct=VC\"];\r\nfor (i in title) {\r\n    var pathname = \"comics/leaderboard?\" + type[i];\r\n    var method = \"GET\";\r\n    var signature = getsignature(pathname, setTime, method);\r\n    var headers = getheaders(setTime, nonce, signature).replace(/\\\"/g, '\\\\\\\"');\r\n    var url = \"https://api.go2778.com/\" + pathname + \",{\\\\\\\"method\\\\\\\":\\\\\\\"GET\\\\\\\",\\\\\\\"headers\\\\\\\":{\" + headers + \"}}\";\r\n    exploreUrl.push(explore(title[i], url, 0x1, 0.25, ![]));\r\n}\r\nexploreUrl.splice(0x0, 0x0, explore(\"?排行榜?\", '', 0x1, 0x1, ![]));\r\nvar exploreUrlStr = '[' + exploreUrl.slice(0, 4).join(',') + ']';\r\nexploreUrlStr;\n</js>",
    "lastUpdateTime": 1736525084721,
    "loginUi": "[\n    {\n        \"name\": \"账号：\",\n        \"type\": \"text\"\n    },\n    {\n        \"name\": \"密码：\",\n        \"type\": \"password\"\n    },\n    {\n        \"name\": \"登录\",\n        \"type\": \"button\",\n        \"action\": \"Login()\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": 1\n        }\n    }\n]",
    "loginUrl": "eval(String(source.bookSourceComment));\r\nfunction Login() {\r\n    Account = result['账号：'] ? result['账号：'] : source.getLoginInfoMap()[\"账号：\"];\r\n    Password = result['密码：'] ? result['密码：'] : source.getLoginInfoMap()[\"密码：\"];\r\n    if (Account == '' && Password == '') {\r\n        login('【登录提示】' + '\\n\\n请输入账号和密码');\r\n    } else if (Account == '') {\r\n        login('【登录提示】' + '\\n\\n请输入账号');\r\n    } else if (Password == '') {\r\n        login('【登录提示】' + '\\n\\n请输入密码');\r\n    } else {\r\n        //请求路径：/auth/sign-in\r\n        var pathname = 'auth/sign-in';\r\n        //请求方式：POST\r\n        var method = \"POST\";\r\n        //请求体：{\"email\":\"274978887\",\"password\":\"sq123456789,.\"}\r\n        var requestBody = '{\"email\":\"' + Account + '\",\"password\":\"' + Password + '\"}';\r\n        //请求头：使用源注释辅助生成\r\n        var signature = getsignature(pathname, setTime, method);\r\n        var headers = \"\\{\\\"time\\\":\\\"\" + setTime + \"\\\",\\\"Content-Type\\\":\\\"application/json; charset=UTF-8\\\",\\\"nonce\\\":\\\"\" + nonce + \"\\\", \\\"signature\\\":\\\"\" + signature + \"\\\",\\\"Accept\\\":\\\"application/vnd.picacomic.com.v1+json\\\",\\\"app-uuid\\\":\\\"webUUID\\\"\\}\";\r\n        var option = {\r\n            \"method\": String(method),\r\n            \"body\": String(requestBody),\r\n            \"headers\": String(headers)\r\n        };\r\n        Response = java.ajax('https://api.go2778.com/auth/sign-in,' + JSON.stringify(option));\r\n        if (JSON.parse(Response).code == 200) {\r\n            let jsondata = JSON.parse(Response);\r\n            let token = jsondata.data.token;\r\n            cache.put(\"authorization\", token);\r\n            java.log(Response);\r\n            login('【登录提示】\\n\\n┏┅━┅━┅━┅━┅┅━┅━┅━┅━┅┓\\n┋┋' + '\\n' + Account + '\\n┋┋' + '\\n??登录成功??\\n┋┋' + '\\n┗┅━┅━┅━┅━┅┅━┅━┅━┅━┅┛');\r\n        } else {\r\n            java.log(Response);\r\n            login('【登录提示】' + '\\n' + Account + '\\n??登录失败??\\n\\n请检查账号和密码');\r\n        }\r\n    }\r\n}\r\n\r\nfunction login(e) {\r\n    if (e == undefined) {\r\n        return;\r\n    }\r\n    java.longToast(e);\r\n}",
    "respondTime": 182494,
    "ruleBookInfo": {
        "init": "",
        "intro": ""
    },
    "ruleContent": {
        "content": "<js>if (/time is not synchronize|the format of accept header is invalid/.test(result)) {\r\n    eval(String(source.bookSourceComment));\r\n    refurshPathname = baseUrl.replace(/(,\\{.*\\})|(https:\\/\\/api.go2778.com\\/)/g, '');\r\n    var method = \"GET\";\r\n    var signature = getsignature(refurshPathname, setTime, method);\r\n    var headers = getheaders(setTime, nonce, signature);\r\n    end = \"https://api.go2778.com/\" + refurshPathname + \",{\\\"method\\\":\\\"GET\\\",\\\"headers\\\":{\\\"image-quality\\\":\\\"original\\\",\" + headers + \"}}\";\r\n    result = java.ajax(end);\r\n} else {\r\n    result = result;\r\n}\r\nvar pattern = /\\\"path\\\": \\\"(.*?)\\\"/g;\r\n//var pattern3 = /\\\"path\\\": \\\"|(\\\")/g;\r\nvar match;\r\nvar tempImg;\r\n(function getImgList() {\r\n    var i = 1;\r\n    var piclist = new Array();\r\n    while ((match = pattern.exec(result)) !== null) {\r\n        tempImg = match[1];\r\n        if (/tobs/.test(tempImg)) {\r\n            tempImg = tempImg.replace(/tobs/g, 'https://storage-b.picacomic.com/static');\r\n        } else {\r\n            tempImg = 'https://s3.picacomic.com/static/' + tempImg;\r\n        }\r\n        piclist[i] = tempImg;\r\n        i++;\r\n    }\r\n    return piclist;\r\n}()).map(url =>\r\n    '<img src=\"' + url + '\">').join(\"\\n\")</js>",
        "imageStyle": "SINGLE",
        "nextContentUrl": "<js>\nif (/time is not synchronize|the format of accept header is invalid/.test(result)) {\r\n    eval(String(source.bookSourceComment));\r\n    refurshPathname = baseUrl.replace(/(,\\{.*\\})|(https:\\/\\/api.go2778.com\\/)/g, '');\r\n    var method = \"GET\";\r\n    var signature = getsignature(refurshPathname, setTime, method);\r\n    var headers = getheaders(setTime, nonce, signature);\r\n    end = \"https://api.go2778.com/\" + refurshPathname + \",{\\\"method\\\":\\\"GET\\\",\\\"headers\\\":{\\\"image-quality\\\":\\\"original\\\",\" + headers + \"}}\";\r\n    result = java.ajax(end);\r\n} else {\r\n    result;\r\n}\r\nlet jsondata = JSON.parse(result);\r\nlet pages = jsondata.data.pages.pages;\r\nlet refurshPathname = baseUrl.replace(/(,\\{.*\\})|(https:\\/\\/api.go2778.com\\/)/g, '');\r\nlet array = [];\r\nif (pages != 1) {\r\n    //array[0] = baseUrl;\r\n    for (var i = 2; i <= pages; i++) {\r\n        page = i;\r\n        eval(String(source.bookSourceComment));\r\n        var endPathname = refurshPathname.replace(/page=1/g, \"page=\" + page);\r\n        //java.log(refurshPathname);\r\n        var method = \"GET\";\r\n        var signature = getsignature(endPathname, setTime, method);\r\n        var headers = getheaders(setTime, nonce, signature);\r\n        var end = \"https://api.go2778.com/\" + endPathname + \",{\\\"method\\\":\\\"GET\\\",\\\"headers\\\":{\\\"image-quality\\\":\\\"original\\\",\" + headers + \"}}\";\r\n        array[i] = end;\r\n    }\r\n}\r\narray;\n</js>",
        "replaceRegex": ""
    },
    "ruleExplore": {
        "author": "author",
        "bookList": "<js>\nif (/time is not synchronize/.test(result)) {\r\n    eval(String(source.bookSourceComment));\r\n    refurshPathname = baseUrl.replace(/(,\\{.*\\})|(https:\\/\\/api.go2778.com\\/)/g, '');\r\n    var method = \"GET\";\n    var setTime = (new Date().getTime() / 1000).toFixed(0);\r\n    var signature = getsignature(refurshPathname, setTime, method);\r\n    var headers = getheaders(setTime, nonce, signature);\r\n    end = \"https://api.go2778.com/\" + refurshPathname + \",{\\\"method\\\":\\\"GET\\\",\\\"headers\\\":{\" + headers + \"}}\";\r\n    result = java.ajax(end);\r\n} else {\r\n    result;\r\n}\nif (/synchronize|unauthorized/.test(result)) {\n    java.longToast(\"请登录\");\n} else {\n    result = result;\n}\n</js>\n$..comics.[*]",
        "bookUrl": "<js>\neval(String(source.bookSourceComment));\nvar pathname = \"comics/\" + '@get:{id}' + \"/eps?page=1\";\nvar method = \"GET\";\nvar signature = getsignature(pathname, setTime, method);\nvar headers = getheaders(setTime, nonce, signature);\nend = \"https://api.go2778.com/\" + pathname + \",{\\\"method\\\":\\\"GET\\\",\\\"headers\\\":{\" + headers + \"}}\";\nend;\n</js>",
        "coverUrl": "thumb.path##tobeimg##https\\:\\/\\/img.go2778.com",
        "kind": "categories",
        "name": "title",
        "wordCount": "@put:{id:$._id}"
    },
    "ruleSearch": {
        "author": "author",
        "bookList": "<js>\nif (/synchronize|unauthorized/.test(result)) {\n    java.longToast(\"请登录\");\n} else {\n    result = result;\n}\n</js>\n$..docs.[*]",
        "bookUrl": "<js>\neval(String(source.bookSourceComment));\nvar pathname = \"comics/\" + '@get:{id}' + \"/eps?page=1\";\nvar method = \"GET\";\nvar signature = getsignature(pathname, setTime, method);\nvar headers = getheaders(setTime, nonce, signature);\nend = \"https://api.go2778.com/\" + pathname + \",{\\\"method\\\":\\\"GET\\\",\\\"headers\\\":{\" + headers + \"}}\";\nend;\n</js>",
        "coverUrl": "thumb.path##tobeimg##https\\:\\/\\/img.go2778.com",
        "intro": "title&&description",
        "kind": "tags",
        "lastChapter": "created_at",
        "name": "title",
        "wordCount": "@put:{id:$._id}"
    },
    "ruleToc": {
        "chapterList": "<js>\nif (/time is not synchronize/.test(result)) {\n    eval(String(source.bookSourceComment));\n    refurshPathname = baseUrl.replace(/(,\\{.*\\})|(https:\\/\\/api.go2778.com\\/)/g, '');\n    var method = \"GET\";\n    var signature = getsignature(refurshPathname, setTime, method);\n    var headers = getheaders(setTime, nonce, signature);\n    end = \"https://api.go2778.com/\" + refurshPathname + \",{\\\"method\\\":\\\"GET\\\",\\\"headers\\\":{\" + headers + \"}}\";\n    result = java.ajax(end);\n} else {\n    result;\n}\n</js>\n$..docs.[*]\n@js:\nresult.toArray().reverse().map(a => JSON.stringify(a));",
        "chapterName": "title",
        "chapterUrl": "order\r\n<js>\neval(String(source.bookSourceComment));\r\nvar jsondata = JSON.parse(result);\r\nvar order = result;\r\nvar id = baseUrl.match(/comics\\/(.*?)\\//)[1];\r\nvar pathname = \"comics/\" + id + \"/order/\" + order + \"/pages?page=1\";\r\nvar method = \"GET\";\r\nvar signature = getsignature(pathname, setTime, method);\r\nvar headers = getheaders(setTime, nonce, signature);\r\nvar end = \"https://api.go2778.com/\" + pathname + \",{\\\"method\\\":\\\"GET\\\",\\\"headers\\\":{\\\"image-quality\\\":\\\"original\\\",\" + headers + \"}}\";\r\nresult = end;\r\n</js>",
        "preUpdateJs": "",
        "updateTime": "updated_at"
    },
    "searchUrl": "<js>\neval(String(source.bookSourceComment));\n(function searchComicList(searchKeys) {\n    var pathname = \"comics/advanced-search?page=\" + page + \"&s=dd\";\n    var method = \"POST\";\n    var body = \"\\{\\\"keyword\\\":\\\"\" + searchKeys + \"\\\",\\\"sort\\\":\\\"dd\\\"\\}\";\n    var signature = getsignature(pathname, setTime, method);\n    var headers = getheaders(setTime, nonce, signature);\n    end = \"https://api.go2778.com/\" + pathname + \",{\\\"method\\\":\\\"POST\\\",\\\"headers\\\":{\" + headers + \"},\\\"body\\\":'\" + body + \"'}\";\n    return end;\n}(key));\n</js>",
    "weight": 0
}